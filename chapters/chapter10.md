# 第10章：运算放大器基础与典型电路

---

## ✨ 开篇段落

本章将深入介绍运算放大器（Op-Amp）的基本原理和典型应用电路。运算放大器是现代电子电路设计中最重要和最常用的集成电路之一，广泛应用于信号放大、滤波、比较、积分、微分等电路。您将学会如何分析理想运放和实际运放的基本特性，掌握反相放大器、同相放大器、加法器、积分器等典型电路的设计方法，以及在实际工程中如何选择合适的运放型号和外围元件。这些知识是模拟电路设计的核心基础。

---

## 📖 内容剖析

### 10.1 运算放大器基本概念

运算放大器是一种高增益、高输入阻抗、低输出阻抗的差分放大器，通常具有两个输入端（同相端+和反相端-）和一个输出端。

#### 10.1.1 理想运放特性

理想运放具有以下特性：
- 开环增益A→∞
- 输入阻抗Ri→∞
- 输出阻抗Ro→0
- 带宽BW→∞
- 共模抑制比CMRR→∞

#### 10.1.2 虚短和虚断概念

基于理想运放特性，可以得出两个重要概念：
- **虚短**：v+ ≈ v-（两输入端电压近似相等）
- **虚断**：i+ ≈ i- ≈ 0（两输入端电流近似为零）

### 10.2 基本运放电路

#### 10.2.1 反相放大器

反相放大器是最基本的运放应用电路，输出信号与输入信号相位相反。

**电路结构**：
```
Vin ----[R1]----[R2]----Vout
              |         |
              |         |
             GND       GND
```

**增益公式**：
```
Av = -R2/R1
```

**输入阻抗**：
```
Zin = R1
```

#### 10.2.2 同相放大器

同相放大器的输出信号与输入信号相位相同，具有高输入阻抗的特点。

**电路结构**：
```
Vin ----[R1]----[R2]----Vout
              |         |
              |         |
             GND       GND
```

**增益公式**：
```
Av = 1 + R2/R1
```

**输入阻抗**：
```
Zin → ∞
```

#### 10.2.3 电压跟随器

电压跟随器是增益为1的同相放大器，主要用于阻抗变换和信号隔离。

**电路结构**：
```
Vin ----Vout
```

**增益公式**：
```
Av = 1
```

### 10.3 运算电路

#### 10.3.1 加法器

加法器可以实现多个输入信号的加权求和。

**电路结构**：
```
V1 ----[R1]----|
V2 ----[R2]----|----[Rf]----Vout
V3 ----[R3]----|
              |
             GND
```

**输出公式**：
```
Vout = -Rf(V1/R1 + V2/R2 + V3/R3)
```

#### 10.3.2 减法器

减法器可以实现两个输入信号的差值放大。

**电路结构**：
```
V1 ----[R1]----[R2]----Vout
              |         |
              |         |
V2 ----[R3]----[R4]----GND
```

**输出公式**：
```
Vout = (R2/R1)(V2 - V1)  (当R1=R3, R2=R4时)
```

### 10.4 积分器和微分器

#### 10.4.1 积分器

积分器可以实现输入信号的积分运算。

**电路结构**：
```
Vin ----[R]----[C]----Vout
              |       |
              |       |
             GND     GND
```

**输出公式**：
```
Vout = -(1/RC)∫Vin dt
```

#### 10.4.2 微分器

微分器可以实现输入信号的微分运算。

**电路结构**：
```
Vin ----[C]----[R]----Vout
              |       |
              |       |
             GND     GND
```

**输出公式**：
```
Vout = -RC(dVin/dt)
```

### 10.5 比较器电路

#### 10.5.1 基本比较器

比较器用于比较两个输入信号的大小，输出高电平或低电平。

**电路结构**：
```
Vin ----[R1]----[R2]----Vref
              |         |
              |         |
             GND       GND
```

**工作原理**：
- 当Vin > Vref时，输出高电平
- 当Vin < Vref时，输出低电平

#### 10.5.2 迟滞比较器

迟滞比较器具有两个阈值，可以避免输出抖动。

**电路结构**：
```
Vin ----[R1]----[R2]----Vout
              |         |
              |         |
             GND       GND
```

**阈值计算**：
```
Vth+ = Vref + (Vcc - Vref)R1/(R1 + R2)
Vth- = Vref - Vref·R1/(R1 + R2)
```

### 10.6 工程实例：传感器信号调理电路设计

**问题描述**：
设计一个温度传感器信号调理电路，将0-100mV的传感器输出放大到0-5V，用于ADC采集。

**设计要求**：
- 输入信号范围：0-100mV
- 输出信号范围：0-5V
- 精度要求：±0.1%
- 温度范围：-40°C到+85°C

**解决方案**：
1. 选择同相放大器结构，避免反相放大器的输入阻抗问题
2. 计算增益：Av = 5V/100mV = 50
3. 选择精密运放LM358，具有低失调电压和低温漂
4. 设计电路：
```
Vsensor ----[R1=1kΩ]----[R2=49kΩ]----Vout
                  |           |
                  |           |
                 GND         GND
```
5. 验证增益：Av = 1 + 49kΩ/1kΩ = 50
6. 添加滤波电容和电源去耦电容

---

## 🧠 本章小结

### 关键知识点

1. **理想运放特性**：无限大增益、无限大输入阻抗、零输出阻抗
2. **虚短虚断**：分析运放电路的基本工具
3. **基本放大器**：反相放大器、同相放大器、电压跟随器
4. **运算电路**：加法器、减法器、积分器、微分器
5. **比较器**：基本比较器、迟滞比较器
6. **实际考虑**：失调电压、温漂、带宽限制

### 重要公式

| 电路类型 | 增益公式 | 特点 |
|---------|---------|------|
| 反相放大器 | Av = -R2/R1 | 输入阻抗低，相位反相 |
| 同相放大器 | Av = 1 + R2/R1 | 输入阻抗高，相位同相 |
| 电压跟随器 | Av = 1 | 阻抗变换，信号隔离 |
| 加法器 | Vout = -Rf(V1/R1 + V2/R2 + ...) | 多信号加权求和 |
| 积分器 | Vout = -(1/RC)∫Vin dt | 时间积分运算 |
| 微分器 | Vout = -RC(dVin/dt) | 时间微分运算 |

### 设计要点

1. **增益稳定性**：使用精密电阻，考虑温度系数
2. **带宽设计**：考虑运放增益带宽积限制
3. **电源设计**：合理选择电源电压，考虑共模范围
4. **噪声控制**：使用低噪声运放，合理布局布线

---

## 🧪 练习题

### 基础题

**1. 反相放大器设计**
设计一个增益为-10的反相放大器，输入阻抗为10kΩ。

<details><summary>答案</summary>

**解答**：
- 增益公式：Av = -R2/R1 = -10
- 输入阻抗：Zin = R1 = 10kΩ
- 因此：R1 = 10kΩ，R2 = 100kΩ

**电路结构**：
```
Vin ----[10kΩ]----[100kΩ]----Vout
              |           |
              |           |
             GND         GND
```
</details>

**2. 同相放大器增益计算**
一个同相放大器中，R1 = 2kΩ，R2 = 18kΩ，求增益。

<details><summary>答案</summary>

**解答**：
- 增益公式：Av = 1 + R2/R1 = 1 + 18kΩ/2kΩ = 1 + 9 = 10
- 因此增益为10倍
</details>

**3. 加法器设计**
设计一个三输入加法器，要求Vout = -(2V1 + 3V2 + V3)。

<details><summary>答案</summary>

**解答**：
- 输出公式：Vout = -Rf(V1/R1 + V2/R2 + V3/R3)
- 比较系数：2 = Rf/R1，3 = Rf/R2，1 = Rf/R3
- 选择Rf = 60kΩ，则R1 = 30kΩ，R2 = 20kΩ，R3 = 60kΩ

**电路结构**：
```
V1 ----[30kΩ]----|
V2 ----[20kΩ]----|----[60kΩ]----Vout
V3 ----[60kΩ]----|
                |
               GND
```
</details>

**4. 积分器时间常数**
一个积分器中R = 10kΩ，C = 1μF，求时间常数。

<details><summary>答案</summary>

**解答**：
- 时间常数：τ = RC = 10kΩ × 1μF = 10ms
- 积分器输出：Vout = -(1/τ)∫Vin dt = -(1/10ms)∫Vin dt
</details>

### 挑战题

**5. 精密仪表放大器设计**
设计一个精密仪表放大器，要求共模抑制比大于80dB，增益可调范围1-1000。

<details><summary>答案</summary>

**解答**：
使用三运放仪表放大器结构：

**电路结构**：
```
Vin+ ----[R1]----[R2]----[R1]----Vout
              |         |
              |         |
Vin- ----[R1]----[R2]----[R1]----GND
              |         |
              |         |
             GND       GND
```

**增益公式**：Av = 1 + 2R2/R1
**设计要点**：
- 选择精密运放如AD620
- 使用精密电阻网络
- 合理布局减少共模干扰
- 添加滤波和去耦电路
</details>

**6. 有源滤波器设计**
设计一个二阶低通有源滤波器，截止频率1kHz，品质因数Q=1。

<details><summary>答案</summary>

**解答**：
使用Sallen-Key低通滤波器结构：

**电路结构**：
```
Vin ----[R1]----[C1]----[R2]----[C2]----Vout
              |       |       |       |
              |       |       |       |
             GND     GND     GND     GND
```

**设计参数**：
- 截止频率：fc = 1/(2π√(R1R2C1C2)) = 1kHz
- 品质因数：Q = √(R1R2C1C2)/(R1C1 + R2C2) = 1
- 选择：R1 = R2 = 10kΩ，C1 = C2 = 15.9nF
</details>

**7. 电压控制振荡器设计**
设计一个压控振荡器，输出频率范围1kHz-10kHz。

<details><summary>答案</summary>

**解答**：
使用积分器+比较器结构：

**电路结构**：
```
Vctrl ----[R1]----[C]----[比较器]----Vout
              |       |           |
              |       |           |
             GND     GND         GND
```

**工作原理**：
- Vctrl控制积分器斜率
- 积分器输出与阈值比较
- 比较器输出反馈控制积分方向
- 频率：f = Vctrl/(4RCVth)

**设计参数**：
- 选择R = 10kΩ，C = 0.1μF
- 阈值电压Vth = 2.5V
- 控制电压范围：0.1V-1V
</details>

**8. 精密整流器设计**
设计一个精密全波整流器，输入信号范围±5V。

<details><summary>答案</summary>

**解答**：
使用运放+二极管结构：

**电路结构**：
```
Vin ----[R1]----[D1]----[R2]----Vout
              |       |       |
              |       |       |
             GND     GND     GND
```

**工作原理**：
- 正半周：D1导通，运放构成反相放大器
- 负半周：D1截止，输出为0
- 使用高速运放和肖特基二极管
- 添加补偿电路改善线性度

**设计要点**：
- 选择高速运放如TL082
- 使用肖特基二极管如1N5819
- 添加补偿电容改善高频响应
</details>

---

## ⚠️ 常见陷阱与错误

### 概念性误解

1. **忽略运放的非理想特性**
   - 错误：认为所有运放都是理想的
   - 正确：考虑失调电压、温漂、带宽限制等实际特性

2. **混淆增益和放大倍数**
   - 错误：认为增益就是放大倍数
   - 正确：增益是输出电压与输入电压的比值，可以是正数或负数

3. **忽视电源电压限制**
   - 错误：认为运放可以输出任意电压
   - 正确：输出受电源电压限制，需要考虑饱和电压

### 电路设计问题

1. **反馈电阻选择不当**
   - 问题：反馈电阻过大导致噪声增加，过小导致功耗过大
   - 解决：根据应用需求合理选择，通常10kΩ-100kΩ

2. **未考虑输入偏置电流**
   - 问题：高阻抗电路中输入偏置电流产生误差
   - 解决：在同相端添加平衡电阻

3. **电源去耦不足**
   - 问题：电源噪声影响运放性能
   - 解决：添加去耦电容，合理布局

### 仿真误差来源

1. **模型参数不准确**
   - 问题：仿真模型与实际器件参数差异
   - 解决：使用厂家提供的精确模型

2. **温度效应未考虑**
   - 问题：温度变化影响运放参数
   - 解决：进行温度分析，选择低温漂器件

---

## ✅ 最佳实践检查清单

### 设计阶段

- [ ] 是否根据应用需求选择了合适的运放类型？
- [ ] 是否考虑了运放的电源电压和共模范围？
- [ ] 是否合理选择了反馈电阻和输入电阻？
- [ ] 是否考虑了输入偏置电流的影响？
- [ ] 是否设计了合适的电源去耦电路？

### 布局布线

- [ ] 是否将模拟地和数字地分开？
- [ ] 是否在运放电源引脚附近添加了去耦电容？
- [ ] 是否避免了信号线与电源线的交叉？
- [ ] 是否使用了短而粗的接地线？
- [ ] 是否考虑了热设计，避免温度梯度？

### 测试验证

- [ ] 是否测量了直流工作点？
- [ ] 是否验证了增益和相位响应？
- [ ] 是否测试了共模抑制比？
- [ ] 是否进行了温度稳定性测试？
- [ ] 是否验证了电源抑制比？

### 文档记录

- [ ] 是否记录了所有关键参数和测试结果？
- [ ] 是否标注了元件的温度系数和精度？
- [ ] 是否记录了布局布线的注意事项？
- [ ] 是否建立了测试程序和验收标准？
- [ ] 是否准备了故障排除指南？ 